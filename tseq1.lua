-- test sequence 1
-- 2016-06-27 17:00:12 Sgurn6i
local b1 = create_body("body1")
local c1 = b1:create_controller("ctlr1")
local j1 = c1:create_joint("joint1")
local j2 = c1:create_joint("joint2")
local j3 = c1:create_joint("joint3")
local j4 = c1:create_joint("joint4")
print( c1:get_name().." children: "..c1:get_children_amt() )
print( b1:get_name().." children: "..b1:get_children_amt() )
local pwmc1 = create_pwmc( "pca9685", "/dev/i2c-2", 0x40, 50 )
c1:attach_pwmc(pwmc1)
local pwmservo1 = create_pwmservo()
pwmservo1:init( 0, "rs304md" )
local pwmservo2 = create_pwmservo( 1, "rs304md" )
local pwmservo3 = create_pwmservo( 2, "rs304md" )
local pwmservo4 = create_pwmservo( 3, "mg996r" )
j1:attach_pwmservo( pwmservo1 )
j2:attach_pwmservo( pwmservo2 )
j3:attach_pwmservo( pwmservo3 )
j4:attach_pwmservo( pwmservo4 )
b1:set_tick(50.0)
print ("tick: " .. b1:get_tick())
-- reset to zero, wait 1sec
j1:target(0)
j2:target(0)
j3:target(0)
j4:target(0)
b1:do_em_in(10)
b1:do_em_in(990)
-- motions
local function f1(jx1,jx2)
--   print("f1")
   jx1:target(0)
   jx2:target(0)
   b1:do_em_in(150)
end
for ix = 0,100 do
   print ("ix " .. ix)
   f1(j1,j2)
   b1:do_em_in(875)
   j1:target(90)
   j3:target(0)
   j4:target(0)
   b1:do_em_in(10)
   j1:target(0)
   j2:target(0)
   b1:do_em_in(650)
   j3:target(144)
   j4:target(90)
   b1:do_em_in(150)
   -- if ix == 5 then break end
   j2:target(45)
   b1:do_em_in(675)
   j1:target(-90)
   j3:target(-144)
   j4:target(-90)
   b1:do_em_in(10)
end
print(j1:get_name() .. " pos: " .. j1:get_curr_pos()) 
print(j2:get_name() .. " pos: " .. j2:get_curr_pos())
-- b1:do_em_in(); -- error
